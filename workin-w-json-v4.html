<!DOCTYPE html>
<html>
    <head>
<script src="https://d3js.org/d3.v4.min.js"></script>  

      <script>

			var h = 150;
			var w = 400;
			//var ds; //empty var for dataset (ds)
			
			
			function showHeader(ds) {
			 
			    d3.select("body").append("h1")
			        .text(ds.category + " Sales (2013)");
			    
			}
			
			function buildLine(ds) {
			
				var xScale = d3.scaleLinear().domain([
					d3.min(ds.monthlySales, function(d) {return d.month}),
					d3.max(ds.monthlySales, function(d) {return d.month})
				]).range([0,w]);
				
				var yScale = d3.scaleLinear()
							.domain([0, d3.max(ds.monthlySales, function(d){return d.sales;})])
							.range([h,0]);  ///otherway makes it upside down
							
                var lineFun = d3.line()
                  .x(function (d) { return xScale(d.month);})      ///((d.month-20130001)/3.25); 
                  .y(function (d) { return yScale(d.sales);})
//.curve(d3.basis)
                  //.interpolate("linear");
                
                var svg = d3.select("body").append("svg").attr("width", w).attr("height", h);
                
                var viz = svg.append("path").attr("d", lineFun(ds.monthlySales)).attr("stroke", "purple").attr("stroke-width", 2).attr("fill", "none"); 


				var labels = svg.selectAll("text")
							.data(ds.monthlySales).enter()
							.append("text")
							.text(function(d){return d.sales;})
							.attr("x", function(d){return ((d.month-20130001)/3.25); })
							.attr("y", function(d) {return h -d.sales -30;})
							.attr("font-family", "sans-serif")
							 .attr("text-anchor", "start").attr("dy", ".35em")
							.attr("font-weight", function(d,i){
							  if(i===0 || i ==(ds.monthlySales.length -1)){
								return "bold"
							  }else { return "normal";}
							  
							})
			}
			
			//call to load data and then build our viz
           //d3.json("MonthlySalesbyCategoryMultiple.json", function(error, data) {
            d3.json("https://api.github.com/repos/bsullins/d3js-resources/contents/monthlySalesbyCategoryMultiple.json", function(error, data) {

			
                //check the file loaded properly
                if (error) { 
                    console.log(error); 
                } else {      
                    console.log(data); 
                }
				
				var decodedData = JSON.parse(window.atob(data.content));
				
				//console.log(decodedData.contents)
				
				
				decodedData.contents.forEach(function(ds){
					//console.log(ds);
					                
                showHeader(ds); //give our chart a title
                buildLine(ds); //draw our line
				})
				})

                
            
               
        </script>
    </head>
    <body>
    </body>
</html>